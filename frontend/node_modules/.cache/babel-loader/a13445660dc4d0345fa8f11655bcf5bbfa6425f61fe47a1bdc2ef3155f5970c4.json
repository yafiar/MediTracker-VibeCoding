{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{useLocation}from'react-router-dom';import{scheduleAPI,intakeAPI,medicineAPI}from'../services/api';import{useToast}from'../context/ToastContext';import{useNotifications}from'../context/NotificationContext';// Local (client-side) notification scheduler for today's medicine times.\n// Uses Web Notifications API; future push support can extend via service worker.\nimport{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const NotificationManager=()=>{const{addToast}=useToast();const{addNotification}=useNotifications();const location=useLocation();const timeoutsRef=useRef([]);const[enabled,setEnabled]=useState(()=>{const saved=localStorage.getItem('notificationsEnabled');return saved===null?true:saved==='true';});const[showText,setShowText]=useState(false);const dayName=new Date().toLocaleDateString('en-US',{weekday:'long'});useEffect(()=>{// Only attempt scheduling inside authenticated routes (not on /login or /register)\nconst token=localStorage.getItem('token');if(!enabled||!token)return;if(location.pathname==='/login'||location.pathname==='/register')return;requestPermission();loadAndSchedule();return()=>{timeoutsRef.current.forEach(t=>clearTimeout(t));timeoutsRef.current=[];};},[enabled,location.pathname]);// Refresh schedule every hour for robustness\nuseEffect(()=>{const token=localStorage.getItem('token');if(!enabled||!token)return;const interval=setInterval(loadAndSchedule,30*60*1000);// every 30 mins refresh\nreturn()=>clearInterval(interval);},[enabled,location.pathname]);const requestPermission=()=>{if(!('Notification'in window)){addToast('Browser does not support notifications','error');return;}if(Notification.permission==='default'){Notification.requestPermission().then(result=>{if(result==='granted')addToast('Notifications enabled','success');else addToast('Notifications permission denied','error');});}};const loadAndSchedule=async()=>{try{// Clear previous timeouts\ntimeoutsRef.current.forEach(t=>clearTimeout(t));timeoutsRef.current=[];const[schedulesRes,todaysIntakesRes,medsRes]=await Promise.all([scheduleAPI.getAll(),// returns normalized single time plus underlying times[]\nintakeAPI.getTodayIntakes(),medicineAPI.getAll({limit:500})// fetch a large batch to cover all medicines\n]);// For duplicate detection: scheduleId + scheduledTime string\nconst takenMap=new Set(todaysIntakesRes.data.map(i=>\"\".concat(i.scheduleId&&i.scheduleId._id||i.scheduleId,\"-\").concat(i.scheduledTime||'')));const medsArray=medsRes.data.items?medsRes.data.items:medsRes.data;const medicinesMap=Object.fromEntries(medsArray.map(m=>[m._id,m]));const now=new Date();const todaySchedules=schedulesRes.data.filter(s=>{if(!s.days||s.days.length===0)return true;return s.days.includes(dayName)||s.days.includes(dayName.substring(0,3));});todaySchedules.forEach(s=>{var _s$medicineId,_s$medicineId2;const medicine=medicinesMap[((_s$medicineId=s.medicineId)===null||_s$medicineId===void 0?void 0:_s$medicineId._id)||s.medicineId]||((_s$medicineId2=s.medicineId)===null||_s$medicineId2===void 0?void 0:_s$medicineId2.medicine)||null;const timesArray=s.times&&s.times.length?s.times:s.time?[s.time]:[];timesArray.forEach(timeStr=>{if(!timeStr)return;const[hh,mm]=timeStr.split(':');if(hh==null||mm==null)return;const scheduled=new Date();scheduled.setHours(parseInt(hh,10),parseInt(mm,10),0,0);if(scheduled<=now)return;// Already passed\nconst key=\"\".concat(s._id,\"-\").concat(timeStr);if(takenMap.has(key))return;// Already taken\nconst delay=scheduled.getTime()-now.getTime();const timeoutId=setTimeout(()=>{fireNotification(medicine,s,timeStr);},delay);timeoutsRef.current.push(timeoutId);});});}catch(err){console.error('Failed to schedule notifications',err);addToast('Failed scheduling notifications','error');}};const fireNotification=(medicine,schedule,timeStr)=>{const title='Medicine Reminder';const body=medicine?\"Time to take \".concat(medicine.name).concat(medicine.dosage?' ('+medicine.dosage+')':'',\" at \").concat(timeStr):\"Time for scheduled medicine at \".concat(timeStr);if('Notification'in window&&Notification.permission==='granted'){new Notification(title,{body,icon:'/favicon.ico'});}addToast(body,'info');addNotification({title,body,medicine,scheduleId:schedule._id,scheduledTime:timeStr});};const toggle=()=>{const next=!enabled;setEnabled(next);localStorage.setItem('notificationsEnabled',String(next));addToast(next?'Notifications turned on':'Notifications turned off',next?'success':'error');// Show text briefly on desktop only\nif(window.innerWidth>768){setShowText(true);setTimeout(()=>setShowText(true));}};// Hide toggle on public pages\nif(location.pathname==='/login'||location.pathname==='/register')return null;const isMobile=window.innerWidth<=768;return/*#__PURE__*/_jsx(\"div\",{className:\"notifications-toggle\",style:{position:'fixed',bottom:18,right:18,zIndex:10},onMouseEnter:()=>!isMobile&&setShowText(true),onMouseLeave:()=>!isMobile&&setShowText(false),children:/*#__PURE__*/_jsxs(\"button\",{onClick:toggle,className:\"nav-btn\",style:{background:enabled?'#4A90E2':'#f0f0f5',color:enabled?'#fff':'#333',transition:'all 0.3s ease',minWidth:isMobile?'44px':showText?'auto':'44px',padding:isMobile?'10px 12px':showText?'10px 18px':'10px 12px'},\"aria-pressed\":enabled,title:enabled?'Notifications On - Click to turn off':'Notifications Off - Click to turn on',children:[enabled?'ðŸ””':'ðŸ”•',!isMobile&&showText&&(enabled?' Notifications On':' Notifications Off')]})});};export default NotificationManager;","map":{"version":3,"names":["React","useEffect","useRef","useState","useLocation","scheduleAPI","intakeAPI","medicineAPI","useToast","useNotifications","jsxs","_jsxs","jsx","_jsx","NotificationManager","addToast","addNotification","location","timeoutsRef","enabled","setEnabled","saved","localStorage","getItem","showText","setShowText","dayName","Date","toLocaleDateString","weekday","token","pathname","requestPermission","loadAndSchedule","current","forEach","t","clearTimeout","interval","setInterval","clearInterval","window","Notification","permission","then","result","schedulesRes","todaysIntakesRes","medsRes","Promise","all","getAll","getTodayIntakes","limit","takenMap","Set","data","map","i","concat","scheduleId","_id","scheduledTime","medsArray","items","medicinesMap","Object","fromEntries","m","now","todaySchedules","filter","s","days","length","includes","substring","_s$medicineId","_s$medicineId2","medicine","medicineId","timesArray","times","time","timeStr","hh","mm","split","scheduled","setHours","parseInt","key","has","delay","getTime","timeoutId","setTimeout","fireNotification","push","err","console","error","schedule","title","body","name","dosage","icon","toggle","next","setItem","String","innerWidth","isMobile","className","style","position","bottom","right","zIndex","onMouseEnter","onMouseLeave","children","onClick","background","color","transition","minWidth","padding"],"sources":["C:/a_ITS/Semester 3/Kelas/PemWeb/MediTracker-VibeCoding/frontend/src/components/NotificationManager.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { scheduleAPI, intakeAPI, medicineAPI } from '../services/api';\r\nimport { useToast } from '../context/ToastContext';\r\nimport { useNotifications } from '../context/NotificationContext';\r\n\r\n// Local (client-side) notification scheduler for today's medicine times.\r\n// Uses Web Notifications API; future push support can extend via service worker.\r\nconst NotificationManager = () => {\r\n  const { addToast } = useToast();\r\n  const { addNotification } = useNotifications();\r\n  const location = useLocation();\r\n  const timeoutsRef = useRef([]);\r\n  const [enabled, setEnabled] = useState(() => {\r\n    const saved = localStorage.getItem('notificationsEnabled');\r\n    return saved === null ? true : saved === 'true';\r\n  });\r\n  const [showText, setShowText] = useState(false);\r\n\r\n  const dayName = new Date().toLocaleDateString('en-US', { weekday: 'long' });\r\n\r\n  useEffect(() => {\r\n    // Only attempt scheduling inside authenticated routes (not on /login or /register)\r\n    const token = localStorage.getItem('token');\r\n    if (!enabled || !token) return;\r\n    if (location.pathname === '/login' || location.pathname === '/register') return;\r\n    requestPermission();\r\n    loadAndSchedule();\r\n    return () => {\r\n      timeoutsRef.current.forEach(t => clearTimeout(t));\r\n      timeoutsRef.current = [];\r\n    };\r\n  }, [enabled, location.pathname]);\r\n\r\n  // Refresh schedule every hour for robustness\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    if (!enabled || !token) return;\r\n    const interval = setInterval(loadAndSchedule, 30 * 60 * 1000); // every 30 mins refresh\r\n    return () => clearInterval(interval);\r\n  }, [enabled, location.pathname]);\r\n\r\n  const requestPermission = () => {\r\n    if (!('Notification' in window)) {\r\n      addToast('Browser does not support notifications', 'error');\r\n      return;\r\n    }\r\n    if (Notification.permission === 'default') {\r\n      Notification.requestPermission().then(result => {\r\n        if (result === 'granted') addToast('Notifications enabled', 'success');\r\n        else addToast('Notifications permission denied', 'error');\r\n      });\r\n    }\r\n  };\r\n\r\n  const loadAndSchedule = async () => {\r\n    try {\r\n      // Clear previous timeouts\r\n      timeoutsRef.current.forEach(t => clearTimeout(t));\r\n      timeoutsRef.current = [];\r\n\r\n      const [schedulesRes, todaysIntakesRes, medsRes] = await Promise.all([\r\n        scheduleAPI.getAll(), // returns normalized single time plus underlying times[]\r\n        intakeAPI.getTodayIntakes(),\r\n        medicineAPI.getAll({ limit: 500 }) // fetch a large batch to cover all medicines\r\n      ]);\r\n\r\n      // For duplicate detection: scheduleId + scheduledTime string\r\n      const takenMap = new Set(\r\n        todaysIntakesRes.data.map(i => `${(i.scheduleId && i.scheduleId._id) || i.scheduleId}-${i.scheduledTime || ''}`)\r\n      );\r\n      const medsArray = medsRes.data.items ? medsRes.data.items : medsRes.data;\r\n      const medicinesMap = Object.fromEntries(medsArray.map(m => [m._id, m]));\r\n      const now = new Date();\r\n\r\n      const todaySchedules = schedulesRes.data.filter(s => {\r\n        if (!s.days || s.days.length === 0) return true;\r\n        return s.days.includes(dayName) || s.days.includes(dayName.substring(0,3));\r\n      });\r\n\r\n      todaySchedules.forEach(s => {\r\n        const medicine = medicinesMap[s.medicineId?._id || s.medicineId] || s.medicineId?.medicine || null;\r\n        const timesArray = s.times && s.times.length ? s.times : (s.time ? [s.time] : []);\r\n        timesArray.forEach(timeStr => {\r\n          if (!timeStr) return;\r\n          const [hh, mm] = timeStr.split(':');\r\n          if (hh == null || mm == null) return;\r\n            const scheduled = new Date();\r\n            scheduled.setHours(parseInt(hh, 10), parseInt(mm, 10), 0, 0);\r\n            if (scheduled <= now) return; // Already passed\r\n            const key = `${s._id}-${timeStr}`;\r\n            if (takenMap.has(key)) return; // Already taken\r\n            const delay = scheduled.getTime() - now.getTime();\r\n            const timeoutId = setTimeout(() => {\r\n              fireNotification(medicine, s, timeStr);\r\n            }, delay);\r\n            timeoutsRef.current.push(timeoutId);\r\n        });\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to schedule notifications', err);\r\n      addToast('Failed scheduling notifications', 'error');\r\n    }\r\n  };\r\n\r\n  const fireNotification = (medicine, schedule, timeStr) => {\r\n    const title = 'Medicine Reminder';\r\n    const body = medicine\r\n      ? `Time to take ${medicine.name}${medicine.dosage ? ' (' + medicine.dosage + ')' : ''} at ${timeStr}`\r\n      : `Time for scheduled medicine at ${timeStr}`;\r\n    if ('Notification' in window && Notification.permission === 'granted') {\r\n      new Notification(title, {\r\n        body,\r\n        icon: '/favicon.ico'\r\n      });\r\n    }\r\n    addToast(body, 'info');\r\n    addNotification({\r\n      title,\r\n      body,\r\n      medicine,\r\n      scheduleId: schedule._id,\r\n      scheduledTime: timeStr\r\n    });\r\n  };\r\n\r\n  const toggle = () => {\r\n    const next = !enabled;\r\n    setEnabled(next);\r\n    localStorage.setItem('notificationsEnabled', String(next));\r\n    addToast(next ? 'Notifications turned on' : 'Notifications turned off', next ? 'success' : 'error');\r\n    // Show text briefly on desktop only\r\n    if (window.innerWidth > 768) {\r\n      setShowText(true);\r\n      setTimeout(() => setShowText(true));\r\n    }\r\n  };\r\n\r\n  // Hide toggle on public pages\r\n  if (location.pathname === '/login' || location.pathname === '/register') return null;\r\n\r\n  const isMobile = window.innerWidth <= 768;\r\n\r\n  return (\r\n    <div \r\n      className=\"notifications-toggle\" \r\n      style={{ position: 'fixed', bottom: 18, right: 18, zIndex: 10 }}\r\n      onMouseEnter={() => !isMobile && setShowText(true)}\r\n      onMouseLeave={() => !isMobile && setShowText(false)}\r\n    >\r\n      <button\r\n        onClick={toggle}\r\n        className=\"nav-btn\"\r\n        style={{ \r\n          background: enabled ? '#4A90E2' : '#f0f0f5', \r\n          color: enabled ? '#fff' : '#333',\r\n          transition: 'all 0.3s ease',\r\n          minWidth: isMobile ? '44px' : (showText ? 'auto' : '44px'),\r\n          padding: isMobile ? '10px 12px' : (showText ? '10px 18px' : '10px 12px')\r\n        }}\r\n        aria-pressed={enabled}\r\n        title={enabled ? 'Notifications On - Click to turn off' : 'Notifications Off - Click to turn on'}\r\n      >\r\n        {enabled ? 'ðŸ””' : 'ðŸ”•'}{!isMobile && showText && (enabled ? ' Notifications On' : ' Notifications Off')}\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationManager;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}