{"ast":null,"code":"var _jsxFileName = \"C:\\\\a_ITS\\\\Semester 3\\\\Kelas\\\\PemWeb\\\\MediTracker-VibeCoding\\\\frontend\\\\src\\\\components\\\\NotificationManager.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { scheduleAPI, intakeAPI, medicineAPI } from '../services/api';\nimport { useToast } from '../context/ToastContext';\nimport { useNotifications } from '../context/NotificationContext';\n\n// Local (client-side) notification scheduler for today's medicine times.\n// Uses Web Notifications API; future push support can extend via service worker.\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NotificationManager = () => {\n  _s();\n  const {\n    addToast\n  } = useToast();\n  const {\n    addNotification\n  } = useNotifications();\n  const location = useLocation();\n  const timeoutsRef = useRef([]);\n  const [enabled, setEnabled] = useState(() => {\n    const saved = localStorage.getItem('notificationsEnabled');\n    return saved === null ? true : saved === 'true';\n  });\n  const dayName = new Date().toLocaleDateString('en-US', {\n    weekday: 'long'\n  });\n  useEffect(() => {\n    // Only attempt scheduling inside authenticated routes (not on /login or /register)\n    const token = localStorage.getItem('token');\n    if (!enabled || !token) return;\n    if (location.pathname === '/login' || location.pathname === '/register') return;\n    requestPermission();\n    loadAndSchedule();\n    return () => {\n      timeoutsRef.current.forEach(t => clearTimeout(t));\n      timeoutsRef.current = [];\n    };\n  }, [enabled, location.pathname]);\n\n  // Refresh schedule every hour for robustness\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!enabled || !token) return;\n    const interval = setInterval(loadAndSchedule, 30 * 60 * 1000); // every 30 mins refresh\n    return () => clearInterval(interval);\n  }, [enabled, location.pathname]);\n  const requestPermission = () => {\n    if (!('Notification' in window)) {\n      addToast('Browser does not support notifications', 'error');\n      return;\n    }\n    if (Notification.permission === 'default') {\n      Notification.requestPermission().then(result => {\n        if (result === 'granted') addToast('Notifications enabled', 'success');else addToast('Notifications permission denied', 'error');\n      });\n    }\n  };\n  const loadAndSchedule = async () => {\n    try {\n      // Clear previous timeouts\n      timeoutsRef.current.forEach(t => clearTimeout(t));\n      timeoutsRef.current = [];\n      const [schedulesRes, todaysIntakesRes, medsRes] = await Promise.all([scheduleAPI.getAll(),\n      // returns normalized single time plus underlying times[]\n      intakeAPI.getTodayIntakes(), medicineAPI.getAll()]);\n\n      // For duplicate detection: scheduleId + scheduledTime string\n      const takenMap = new Set(todaysIntakesRes.data.map(i => `${i.scheduleId && i.scheduleId._id || i.scheduleId}-${i.scheduledTime || ''}`));\n      const medicinesMap = Object.fromEntries(medsRes.data.map(m => [m._id, m]));\n      const now = new Date();\n      const todaySchedules = schedulesRes.data.filter(s => {\n        if (!s.days || s.days.length === 0) return true;\n        return s.days.includes(dayName) || s.days.includes(dayName.substring(0, 3));\n      });\n      todaySchedules.forEach(s => {\n        var _s$medicineId, _s$medicineId2;\n        const medicine = medicinesMap[((_s$medicineId = s.medicineId) === null || _s$medicineId === void 0 ? void 0 : _s$medicineId._id) || s.medicineId] || ((_s$medicineId2 = s.medicineId) === null || _s$medicineId2 === void 0 ? void 0 : _s$medicineId2.medicine) || null;\n        const timesArray = s.times && s.times.length ? s.times : s.time ? [s.time] : [];\n        timesArray.forEach(timeStr => {\n          if (!timeStr) return;\n          const [hh, mm] = timeStr.split(':');\n          if (hh == null || mm == null) return;\n          const scheduled = new Date();\n          scheduled.setHours(parseInt(hh, 10), parseInt(mm, 10), 0, 0);\n          if (scheduled <= now) return; // Already passed\n          const key = `${s._id}-${timeStr}`;\n          if (takenMap.has(key)) return; // Already taken\n          const delay = scheduled.getTime() - now.getTime();\n          const timeoutId = setTimeout(() => {\n            fireNotification(medicine, s, timeStr);\n          }, delay);\n          timeoutsRef.current.push(timeoutId);\n        });\n      });\n    } catch (err) {\n      console.error('Failed to schedule notifications', err);\n      addToast('Failed scheduling notifications', 'error');\n    }\n  };\n  const fireNotification = (medicine, schedule, timeStr) => {\n    const title = 'Medicine Reminder';\n    const body = medicine ? `Time to take ${medicine.name}${medicine.dosage ? ' (' + medicine.dosage + ')' : ''} at ${timeStr}` : `Time for scheduled medicine at ${timeStr}`;\n    if ('Notification' in window && Notification.permission === 'granted') {\n      new Notification(title, {\n        body,\n        icon: '/favicon.ico'\n      });\n    }\n    addToast(body, 'info');\n    addNotification({\n      title,\n      body,\n      medicine,\n      scheduleId: schedule._id,\n      scheduledTime: timeStr\n    });\n  };\n  const toggle = () => {\n    const next = !enabled;\n    setEnabled(next);\n    localStorage.setItem('notificationsEnabled', String(next));\n    addToast(next ? 'Notifications turned on' : 'Notifications turned off', next ? 'success' : 'error');\n  };\n\n  // Hide toggle on public pages\n  if (location.pathname === '/login' || location.pathname === '/register') return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"notifications-toggle\",\n    style: {\n      position: 'fixed',\n      bottom: 18,\n      right: 18,\n      zIndex: 250\n    },\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: toggle,\n      className: \"nav-btn\",\n      style: {\n        background: enabled ? '#667eea' : '#f0f0f5',\n        color: enabled ? '#fff' : '#333'\n      },\n      \"aria-pressed\": enabled,\n      title: \"Toggle local medicine reminders\",\n      children: enabled ? 'ðŸ”” Notifications On' : 'ðŸ”• Notifications Off'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 136,\n    columnNumber: 5\n  }, this);\n};\n_s(NotificationManager, \"rWBA3jsz638mC4+ruBwJ7xyVpuk=\", false, function () {\n  return [useToast, useNotifications, useLocation];\n});\n_c = NotificationManager;\nexport default NotificationManager;\nvar _c;\n$RefreshReg$(_c, \"NotificationManager\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useLocation","scheduleAPI","intakeAPI","medicineAPI","useToast","useNotifications","jsxDEV","_jsxDEV","NotificationManager","_s","addToast","addNotification","location","timeoutsRef","enabled","setEnabled","saved","localStorage","getItem","dayName","Date","toLocaleDateString","weekday","token","pathname","requestPermission","loadAndSchedule","current","forEach","t","clearTimeout","interval","setInterval","clearInterval","window","Notification","permission","then","result","schedulesRes","todaysIntakesRes","medsRes","Promise","all","getAll","getTodayIntakes","takenMap","Set","data","map","i","scheduleId","_id","scheduledTime","medicinesMap","Object","fromEntries","m","now","todaySchedules","filter","s","days","length","includes","substring","_s$medicineId","_s$medicineId2","medicine","medicineId","timesArray","times","time","timeStr","hh","mm","split","scheduled","setHours","parseInt","key","has","delay","getTime","timeoutId","setTimeout","fireNotification","push","err","console","error","schedule","title","body","name","dosage","icon","toggle","next","setItem","String","className","style","position","bottom","right","zIndex","children","onClick","background","color","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/a_ITS/Semester 3/Kelas/PemWeb/MediTracker-VibeCoding/frontend/src/components/NotificationManager.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { scheduleAPI, intakeAPI, medicineAPI } from '../services/api';\r\nimport { useToast } from '../context/ToastContext';\r\nimport { useNotifications } from '../context/NotificationContext';\r\n\r\n// Local (client-side) notification scheduler for today's medicine times.\r\n// Uses Web Notifications API; future push support can extend via service worker.\r\nconst NotificationManager = () => {\r\n  const { addToast } = useToast();\r\n  const { addNotification } = useNotifications();\r\n  const location = useLocation();\r\n  const timeoutsRef = useRef([]);\r\n  const [enabled, setEnabled] = useState(() => {\r\n    const saved = localStorage.getItem('notificationsEnabled');\r\n    return saved === null ? true : saved === 'true';\r\n  });\r\n\r\n  const dayName = new Date().toLocaleDateString('en-US', { weekday: 'long' });\r\n\r\n  useEffect(() => {\r\n    // Only attempt scheduling inside authenticated routes (not on /login or /register)\r\n    const token = localStorage.getItem('token');\r\n    if (!enabled || !token) return;\r\n    if (location.pathname === '/login' || location.pathname === '/register') return;\r\n    requestPermission();\r\n    loadAndSchedule();\r\n    return () => {\r\n      timeoutsRef.current.forEach(t => clearTimeout(t));\r\n      timeoutsRef.current = [];\r\n    };\r\n  }, [enabled, location.pathname]);\r\n\r\n  // Refresh schedule every hour for robustness\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    if (!enabled || !token) return;\r\n    const interval = setInterval(loadAndSchedule, 30 * 60 * 1000); // every 30 mins refresh\r\n    return () => clearInterval(interval);\r\n  }, [enabled, location.pathname]);\r\n\r\n  const requestPermission = () => {\r\n    if (!('Notification' in window)) {\r\n      addToast('Browser does not support notifications', 'error');\r\n      return;\r\n    }\r\n    if (Notification.permission === 'default') {\r\n      Notification.requestPermission().then(result => {\r\n        if (result === 'granted') addToast('Notifications enabled', 'success');\r\n        else addToast('Notifications permission denied', 'error');\r\n      });\r\n    }\r\n  };\r\n\r\n  const loadAndSchedule = async () => {\r\n    try {\r\n      // Clear previous timeouts\r\n      timeoutsRef.current.forEach(t => clearTimeout(t));\r\n      timeoutsRef.current = [];\r\n\r\n      const [schedulesRes, todaysIntakesRes, medsRes] = await Promise.all([\r\n        scheduleAPI.getAll(), // returns normalized single time plus underlying times[]\r\n        intakeAPI.getTodayIntakes(),\r\n        medicineAPI.getAll()\r\n      ]);\r\n\r\n      // For duplicate detection: scheduleId + scheduledTime string\r\n      const takenMap = new Set(\r\n        todaysIntakesRes.data.map(i => `${(i.scheduleId && i.scheduleId._id) || i.scheduleId}-${i.scheduledTime || ''}`)\r\n      );\r\n      const medicinesMap = Object.fromEntries(medsRes.data.map(m => [m._id, m]));\r\n      const now = new Date();\r\n\r\n      const todaySchedules = schedulesRes.data.filter(s => {\r\n        if (!s.days || s.days.length === 0) return true;\r\n        return s.days.includes(dayName) || s.days.includes(dayName.substring(0,3));\r\n      });\r\n\r\n      todaySchedules.forEach(s => {\r\n        const medicine = medicinesMap[s.medicineId?._id || s.medicineId] || s.medicineId?.medicine || null;\r\n        const timesArray = s.times && s.times.length ? s.times : (s.time ? [s.time] : []);\r\n        timesArray.forEach(timeStr => {\r\n          if (!timeStr) return;\r\n          const [hh, mm] = timeStr.split(':');\r\n          if (hh == null || mm == null) return;\r\n            const scheduled = new Date();\r\n            scheduled.setHours(parseInt(hh, 10), parseInt(mm, 10), 0, 0);\r\n            if (scheduled <= now) return; // Already passed\r\n            const key = `${s._id}-${timeStr}`;\r\n            if (takenMap.has(key)) return; // Already taken\r\n            const delay = scheduled.getTime() - now.getTime();\r\n            const timeoutId = setTimeout(() => {\r\n              fireNotification(medicine, s, timeStr);\r\n            }, delay);\r\n            timeoutsRef.current.push(timeoutId);\r\n        });\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to schedule notifications', err);\r\n      addToast('Failed scheduling notifications', 'error');\r\n    }\r\n  };\r\n\r\n  const fireNotification = (medicine, schedule, timeStr) => {\r\n    const title = 'Medicine Reminder';\r\n    const body = medicine\r\n      ? `Time to take ${medicine.name}${medicine.dosage ? ' (' + medicine.dosage + ')' : ''} at ${timeStr}`\r\n      : `Time for scheduled medicine at ${timeStr}`;\r\n    if ('Notification' in window && Notification.permission === 'granted') {\r\n      new Notification(title, {\r\n        body,\r\n        icon: '/favicon.ico'\r\n      });\r\n    }\r\n    addToast(body, 'info');\r\n    addNotification({\r\n      title,\r\n      body,\r\n      medicine,\r\n      scheduleId: schedule._id,\r\n      scheduledTime: timeStr\r\n    });\r\n  };\r\n\r\n  const toggle = () => {\r\n    const next = !enabled;\r\n    setEnabled(next);\r\n    localStorage.setItem('notificationsEnabled', String(next));\r\n    addToast(next ? 'Notifications turned on' : 'Notifications turned off', next ? 'success' : 'error');\r\n  };\r\n\r\n  // Hide toggle on public pages\r\n  if (location.pathname === '/login' || location.pathname === '/register') return null;\r\n\r\n  return (\r\n    <div className=\"notifications-toggle\" style={{ position: 'fixed', bottom: 18, right: 18, zIndex: 250 }}>\r\n      <button\r\n        onClick={toggle}\r\n        className=\"nav-btn\"\r\n        style={{ background: enabled ? '#667eea' : '#f0f0f5', color: enabled ? '#fff' : '#333' }}\r\n        aria-pressed={enabled}\r\n        title=\"Toggle local medicine reminders\"\r\n      >\r\n        {enabled ? 'ðŸ”” Notifications On' : 'ðŸ”• Notifications Off'}\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationManager;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}